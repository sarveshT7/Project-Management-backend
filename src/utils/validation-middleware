// // src/middleware/validation.ts
// import { Request, Response, NextFunction } from 'express';
// import { z } from 'zod';

// export const validate = (schema: z.ZodSchema) => {
//   return (req: Request, res: Response, next: NextFunction) => {
//     try {
//       schema.parse(req.body);
//       next();
//     } catch (error) {
//       if (error instanceof z.ZodError) {
//         const errors = error.errors.map(err => ({
//           field: err.path.join('.'),
//           message: err.message
//         }));

//         return res.status(400).json({
//           success: false,
//           message: 'Validation error',
//           errors
//         });
//       }

//       next(error);
//     }
//   };
// };

// export const validateQuery = (schema: z.ZodSchema) => {
//   return (req: Request, res: Response, next: NextFunction) => {
//     try {
//       schema.parse(req.query);
//       next();
//     } catch (error) {
//       if (error instanceof z.ZodError) {
//         const errors = error.errors.map(err => ({
//           field: err.path.join('.'),
//           message: err.message
//         }));

//         return res.status(400).json({
//           success: false,
//           message: 'Query validation error',
//           errors
//         });
//       }

//       next(error);
//     }
//   };
// };

// export const validateParams = (schema: z.ZodSchema) => {
//   return (req: Request, res: Response, next: NextFunction) => {
//     try {
//       schema.parse(req.params);
//       next();
//     } catch (error) {
//       if (error instanceof z.ZodError) {
//         const errors = error.errors.map(err => ({
//           field: err.path.join('.'),
//           message: err.message
//         }));

//         return res.status(400).json({
//           success: false,
//           message: 'Parameter validation error',
//           errors
//         });
//       }

//       next(error);
//     }
//   };
// };

// // Custom Zod refinements and transforms
// const objectId = z.string().regex(/^[0-9a-fA-F]{24}$/, "Invalid ObjectId");
// const phoneNumber = z.string().regex(/^[+]?[1-9][\d\s\-\(\)]{7,15}$/, "Invalid phone number");
// const timeFormat = z.string().regex(/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/, "Invalid time format (HH:MM)");

// // Validation schemas
// export const schemas = {
//   // User schemas
//   register: z.object({
//     name: z.string().min(2, "Name must be at least 2 characters").max(50, "Name cannot exceed 50 characters"),
//     email: z.string().email("Invalid email format"),
//     password: z.string().min(6, "Password must be at least 6 characters"),
//     role: z.enum(['user', 'admin']).default('user')
//   }),

//   login: z.object({
//     email: z.string().email("Invalid email format"),
//     password: z.string().min(1, "Password is required")
//   }),

//   updateProfile: z.object({
//     name: z.string().min(2).max(50).optional(),
//     email: z.string().email().optional(),
//     bio: z.string().max(500, "Bio cannot exceed 500 characters").optional(),
//     avatar: z.string().url("Invalid URL format").optional(),
//     phone: phoneNumber.optional(),
//     timezone: z.string().optional()
//   }),

//   changePassword: z.object({
//     currentPassword: z.string().min(1, "Current password is required"),
//     newPassword: z.string().min(6, "New password must be at least 6 characters")
//   }),

//   deleteAccount: z.object({
//     password: z.string().min(1, "Password is required")
//   }),

//   // Project schemas
//   createProject: z.object({
//     name: z.string().min(2, "Name must be at least 2 characters").max(100, "Name cannot exceed 100 characters"),
//     description: z.string().max(1000, "Description cannot exceed 1000 characters").optional(),
//     status: z.enum(['planning', 'active', 'completed', 'on-hold']).default('planning'),
//     priority: z.enum(['low', 'medium', 'high']).default('medium'),
//     deadline: z.string().datetime().optional().or(z.date().optional()),
//     teamId: objectId.optional()
//   }),

//   updateProject: z.object({
//     name: z.string().min(2).max(100).optional(),
//     description: z.string().max(1000).optional(),
//     status: z.enum(['planning', 'active', 'completed', 'on-hold']).optional(),
//     priority: z.enum(['low', 'medium', 'high']).optional(),
//     deadline: z.string().datetime().optional().or(z.date().optional()),
//     teamId: objectId.optional()
//   }),

//   // Task schemas
//   createTask: z.object({
//     title: z.string().min(2, "Title must be at least 2 characters").max(200, "Title cannot exceed 200 characters"),
//     description: z.string().max(2000, "Description cannot exceed 2000 characters").optional(),
//     status: z.enum(['todo', 'in-progress', 'review', 'done']).default('todo'),
//     priority: z.enum(['low', 'medium', 'high']).default('medium'),
//     deadline: z.string().datetime().optional().or(z.date().optional()),
//     projectId: objectId,
//     assignedTo: objectId.optional(),
//     tags: z.array(z.string().max(50)).optional(),
//     estimatedHours: z.number().min(0, "Estimated hours cannot be negative").max(1000, "Estimated hours cannot exceed 1000").optional()
//   }),

//   updateTask: z.object({
//     title: z.string().min(2).max(200).optional(),
//     description: z.string().max(2000).optional(),
//     status: z.enum(['todo', 'in-progress', 'review', 'done']).optional(),
//     priority: z.enum(['low', 'medium', 'high']).optional(),
//     deadline: z.string().datetime().optional().or(z.date().optional()),
//     assignedTo: objectId.optional(),
//     tags: z.array(z.string().max(50)).optional(),
//     estimatedHours: z.number().min(0).max(1000).optional(),
//     actualHours: z.number().min(0).max(1000).optional()
//   }),

//   updateTaskStatus: z.object({
//     status: z.enum(['todo', 'in-progress', 'review', 'done'])
//   }),

//   addComment: z.object({
//     content: z.string().min(1, "Comment cannot be empty").max(1000, "Comment cannot exceed 1000 characters")
//   }),

//   // Team schemas
//   createTeam: z.object({
//     name: z.string().min(2, "Name must be at least 2 characters").max(100, "Name cannot exceed 100 characters"),
//     description: z.string().max(1000, "Description cannot exceed 1000 characters").optional()
//   }),

//   updateTeam: z.object({
//     name: z.string().min(2).max(100).optional(),
//     description: z.string().max(1000).optional()
//   }),

//   addMember: z.object({
//     userId: objectId
//   }),

//   // Settings schemas
//   updateSettings: z.object({
//     theme: z.enum(['light', 'dark', 'system']).optional(),
//     language: z.enum(['en', 'es', 'fr', 'de', 'it', 'pt', 'ru', 'ja', 'ko', 'zh']).optional(),
//     timezone: z.string().optional(),
//     emailNotifications: z.object({
//       taskAssigned: z.boolean().optional(),
//       taskDue: z.boolean().optional(),
//       projectUpdates: z.boolean().optional(),
//       teamInvites: z.boolean().optional(),
//       weeklyDigest: z.boolean().optional()
//     }).optional(),
//     pushNotifications: z.object({
//       taskAssigned: z.boolean().optional(),
//       taskDue: z.boolean().optional(),
//       projectUpdates: z.boolean().optional(),
//       mentions: z.boolean().optional()
//     }).optional(),
//     workPreferences: z.object({
//       workingHours: z.object({
//         start: timeFormat.optional(),
//         end: timeFormat.optional()
//       }).optional(),
//       workingDays: z.array(
//         z.enum(['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'])
//       ).optional(),
//       autoAssignTasks: z.boolean().optional()
//     }).optional(),
//     privacy: z.object({
//       profileVisible: z.boolean().optional(),
//       statusVisible: z.boolean().optional(),
//       activityVisible: z.boolean().optional()
//     }).optional()
//   }),

//   updateNotificationSettings: z.object({
//     emailNotifications: z.object({
//       taskAssigned: z.boolean().optional(),
//       taskDue: z.boolean().optional(),
//       projectUpdates: z.boolean().optional(),
//       teamInvites: z.boolean().optional(),
//       weeklyDigest: z.boolean().optional()
//     }).optional(),
//     pushNotifications: z.object({
//       taskAssigned: z.boolean().optional(),
//       taskDue: z.boolean().optional(),
//       projectUpdates: z.boolean().optional(),
//       mentions: z.boolean().optional()
//     }).optional()
//   })
// };

// // Parameter validation schemas
// export const paramSchemas = {
//   objectId: z.object({
//     id: objectId
//   }),

//   projectId: z.object({
//     projectId: objectId
//   }),

//   userIdParam: z.object({
//     userId: objectId
//   }),

//   teamMember: z.object({
//     id: objectId,
//     userId: objectId
//   })
// };

// // Query validation schemas
// export const querySchemas = {
//   pagination: z.object({
//     page: z.string().regex(/^\d+$/).transform(Number).optional(),
//     limit: z.string().regex(/^\d+$/).transform(Number).optional(),
//     sortBy: z.string().optional(),
//     sortOrder: z.enum(['asc', 'desc']).optional()
//   }),

//   projectsQuery: z.object({
//     status: z.enum(['planning', 'active', 'completed', 'on-hold']).optional(),
//     priority: z.enum(['low', 'medium', 'high']).optional(),
//     page: z.string().regex(/^\d+$/).transform(Number).optional(),
//     limit: z.string().regex(/^\d+$/).transform(Number).optional()
//   }),

//   tasksQuery: z.object({
//     projectId: objectId.optional(),
//     status: z.enum(['todo', 'in-progress', 'review', 'done']).optional(),
//     priority: z.enum(['low', 'medium', 'high']).optional(),
//     assignedTo: objectId.optional(),
//     page: z.string().regex(/^\d+$/).transform(Number).optional(),
//     limit: z.string().regex(/^\d+$/).transform(Number).optional(),
//     sortBy: z.string().optional(),
//     sortOrder: z.enum(['asc', 'desc']).optional()
//   }),

//   searchUsers: z.object({
//     q: z.string().min(2, "Search query must be at least 2 characters")
//   }),

//   analyticsQuery: z.object({
//     projectId: objectId.optional(),
//     teamId: objectId.optional(),
//     period: z.string().regex(/^\d+$/).transform(Number).optional()
//   })
// };